"0","risk_diff <- function(tab, conf.level=.95){"
"0","  phat1 <- tab[1,1]/(tab[1,1]+tab[1,2])"
"0","  phat2 <- tab[2,1]/(tab[2,1]+tab[2,2])"
"0","  RD <- phat1 - phat2"
"0","  lowerBound <- RD - qnorm(1-(1-conf.level)/2) * sqrt(((phat1*(1-phat1))/(tab[1,1]+tab[1,2])) + ((phat2*(1-phat2))/(tab[2,1]+tab[2,2])))"
"0","  upperBound <- RD + qnorm(1-(1-conf.level)/2) * sqrt(((phat1*(1-phat1))/(tab[1,1]+tab[1,2])) + ((phat2*(1-phat2))/(tab[2,1]+tab[2,2])))"
"0","  output <- c(RD, lowerBound, upperBound)"
"0","  names(output) <- c(""risk difference"", ""RD CI lower"", ""RD CI upper"")"
"0","  print(output)"
"0","}"
"0",""
"0","risk_ratio <- function(tab, conf.level=.95){"
"0","  phat1 <- tab[1,1]/(tab[1,1]+tab[1,2])"
"0","  phat2 <- tab[2,1]/(tab[2,1]+tab[2,2])"
"0","  RR <- phat1/phat2"
"0","  lowerBound <- exp(log(RR) - qnorm(1-(1-conf.level)/2) * sqrt((tab[1,2] / (tab[1,1]*(tab[1,1]+tab[1,2]))) + (tab[2,2]/(tab[2,1]*(tab[2,1]+tab[2,2])))))"
"0","  upperBound <- exp(log(RR) + qnorm(1-(1-conf.level)/2) * sqrt((tab[1,2] / (tab[1,1]*(tab[1,1]+tab[1,2]))) + (tab[2,2]/(tab[2,1]*(tab[2,1]+tab[2,2])))))"
"0","  output <- c(RR, lowerBound, upperBound)"
"0","  names(output) <- c(""risk ratio"", ""RR CI lower"", ""RR CI upper"")"
"0","  print(output)"
"0","}"
"0",""
"0","odds_ratio <- function(tab, conf.level=.95){"
"0","  phat1 <- tab[1,1]/(tab[1,1]+tab[1,2])"
"0","  phat2 <- tab[2,1]/(tab[2,1]+tab[2,2])"
"0","  OR <- (phat1/(1-phat1))/(phat2/(1-phat2))"
"0","  lowerBound <- exp(log(OR) - qnorm(1-(1-conf.level)/2) * sqrt((1/tab[1,1]) + (1/tab[1,2]) + (1/tab[2,1]) + (1/tab[2,2])))"
"0","  upperBound <- exp(log(OR) + qnorm(1-(1-conf.level)/2) * sqrt((1/tab[1,1]) + (1/tab[1,2]) + (1/tab[2,1]) + (1/tab[2,2])))"
"0","  output <- c(OR, lowerBound, upperBound)"
"0","  names(output) <- c(""odds ratio"", ""OR CI lower"", ""OR CI upper"")"
"0","  print(output)"
"0","}"
